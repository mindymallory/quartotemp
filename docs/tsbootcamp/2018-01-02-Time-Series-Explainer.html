<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>quarto-test-website - Basic Time-Series Analysis, the Game</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">quarto-test-website</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tsbootcamp.html">
 <span class="menu-text">Time Series Bootcamp</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-game" id="toc-the-game" class="nav-link active" data-scroll-target="#the-game">The Game</a>
  <ul class="collapse">
  <li><a href="#stationary-and-non-stationary-data-and-issues" id="toc-stationary-and-non-stationary-data-and-issues" class="nav-link" data-scroll-target="#stationary-and-non-stationary-data-and-issues">Stationary and Non-Stationary Data and Issues</a></li>
  </ul></li>
  <li><a href="#stationarity-testing" id="toc-stationarity-testing" class="nav-link" data-scroll-target="#stationarity-testing">Stationarity Testing</a>
  <ul class="collapse">
  <li><a href="#unit-root-and-stationarity-test-results-for-spy-and-gs" id="toc-unit-root-and-stationarity-test-results-for-spy-and-gs" class="nav-link" data-scroll-target="#unit-root-and-stationarity-test-results-for-spy-and-gs">Unit Root and Stationarity Test Results for SPY and GS</a></li>
  </ul></li>
  <li><a href="#books-to-get-you-started" id="toc-books-to-get-you-started" class="nav-link" data-scroll-target="#books-to-get-you-started">Books to Get You Started</a>
  <ul class="collapse">
  <li><a href="#enders-applied-time-series-econometrics" id="toc-enders-applied-time-series-econometrics" class="nav-link" data-scroll-target="#enders-applied-time-series-econometrics">Enders’ Applied Time Series Econometrics</a></li>
  <li><a href="#colonescus-using-r-for-principles-of-econometrics" id="toc-colonescus-using-r-for-principles-of-econometrics" class="nav-link" data-scroll-target="#colonescus-using-r-for-principles-of-econometrics">Colonescu’s Using R for Principles of Econometrics</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Basic Time-Series Analysis, the Game</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<meta property="og:title" content="quarto-test-website - Basic Time-Series Analysis, the Game">
<meta property="og:description" content="Even for students who are well trained in econometrics-statistics, getting started with time-series analysis can be mystifying.">
<meta property="”og:type”" content="”article”">
<p>When graduate students approach me hoping to start research in price analysis, they usually have to start from ground zero in terms of their time-series statistical training. Even incoming graduate students well trained in econometrics often have seen little, if any, treatment of time-series techniques because first and even second econometrics courses focus most of their time on cross-sectional and panel techniques.</p>
<p>For the graduate student aspiring to do a (Ph.D.) dissertation or (M.S.) thesis in price analysis this is a real bummer because it often will be 6 to 18 months before they can work a formal time-series course into their schedule, severely delaying their research unless they can learn a lot on their own.</p>
<p>This series of posts is for my current and future new-ish graduate students who will soon start research in applied price analysis or finance, but feel overwhelmed and under-prepared in the ways of time-series econometrics (this is totally normal, by the way). I hope it will also be accessible to anyone who has had a basic class in statistics (through linear regression), and an interest in price analysis or forecasting.</p>
<p>When you start a time-series class or read a paper that uses time-series analysis for the first time you are greeted by a barrage of new statistical tests and terms like, “Augmented Dickey-Fuller (ADF) Test”, “Johansen’s Cointegration Test”, “AR(p)”, “GARCH(p,q)”, “Vector Autoregression (VAR)” and “Vector Error Correction Model (VECM)” to name a few.</p>
<p>Since a statistics or econometrics class has to cover so much… well, statistics, sometimes the forest can be lost for the trees in how all these tests and models can help one build a case around the research question they care about.</p>
<p>I’m not going to get too deep into the details of these issues; for that I link to resources for how you can start to learn more on your own at the bottom. Rather, in this series I give a 30,000 ft view of ‘The Game’ that is going on in applied time-series analysis. It follows a fairly standard template.</p>
<section id="the-game" class="level1">
<h1>The Game</h1>
<p>Most introductory time-series efforts are utilized toward one of the following three goals:</p>
<ul>
<li><p>Stationary and Non-Stationary Data and Issues</p></li>
<li><p>Determining if Variables “Move Together” or are Otherwise Correlated</p></li>
<li><p>Adjusting for Residuals that may not be Perfect “White Noise”</p></li>
</ul>
<p>Each of these can be thought of as a model selection exercise, helping you to pick which statistical model is the right choice for your research question. After a while you will have an intuition about which model to use on which kind of data; even then you have to go through this process in every research project to convince your reader that you did, in fact, choose a suitable model for the question at hand.</p>
<p>If you are new to this you probably don’t have any intuition about what the right model is for your question, but going through these three issues will lead you there anyway.</p>
<p>In the rest of this post we will cover ‘Stationary and Non-Stationary Data and Issues’. Later posts will cover the second and third bullets.</p>
<section id="stationary-and-non-stationary-data-and-issues" class="level2">
<h2 class="anchored" data-anchor-id="stationary-and-non-stationary-data-and-issues">Stationary and Non-Stationary Data and Issues</h2>
<p>The first thing you have to establish in any time-series analysis is whether your data are stationary or not because it essentially determines whether you should try to model levels of the data or first differences of the data.</p>
<p>If you want to see the R code that generates any of the following stuff, visit <a href="https://github.com/mindymallory/BlogPosts/blob/master/2018-01-02-Time-Series-Explainer.Rmd">my Github repostory</a> that has the source code for this blog post.</p>
<p><strong>Stationary Data</strong></p>
<p>In the figure below I simulate and plot a stationary series. The series comes from 500 draws of a normal distribution with mean = 300 and standard deviation = 0.25. Notice that it is basically flat, with random ups and downs.</p>
<p>That is basically what stationarity means, all the data come from a single probability distribution.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-2_204220cb906b715c88955b377d6661b5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you are following along, uncomment the next lines and run once to install the required packages </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('ggplot2')</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('xts')</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("stargazer")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('quantmod')</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('sde')</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('broom')</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('tseries')</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("kableExtra")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("knitr")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># These lines 'load' the required packages, something you have to do every time you start an R session, even if the package is installed on your machine.  </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Making the fake price series</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Dates</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>end     <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>start   <span class="ot">&lt;-</span> end <span class="sc">-</span> <span class="dv">499</span> </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>t       <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(start<span class="sc">:</span>end)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 500 fake prices from a normal distribution</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>x       <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">mean =</span> <span class="dv">300</span>, <span class="at">sd =</span> .<span class="dv">25</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Put dates and prices together in a time-series object</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>p       <span class="ot">&lt;-</span> <span class="fu">as.xts</span>(x, <span class="at">order.by =</span> t)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot It</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(p, <span class="at">ts.colour =</span> <span class="st">"dark blue"</span>) <span class="sc">+</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fake Stationary Price Series Centered around P = $300"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Price"</span>) <span class="sc">+</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%m-%d-%Y"</span>, <span class="at">date_breaks =</span> <span class="st">"3 month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2018-01-02-Time-Series-Explainer_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When you look at this plot it is not hard to imagine that it came from draws from a single probability distribution, namely:</p>
<p><span class="math display">\[p_t \sim N(\mu = 300, \sigma = .25)\]</span></p>
<p>We need our data to be stationary in order to be able to do statistical tests and modelling on it. So if the data is not stationary, we have to transform it so it is and do our analysis on the transformed variable. The next sub-section should explain why.</p>
<p><strong>Non-Stationary or Unit Root Data</strong></p>
<p>Below I plot SPY, the exchange traded fund that tracks the S&amp;P 500 Index, from 1990 to 2017. By visual inspection you should have a sense that this series is non-stationary in that the prices appear to be trending.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-3_6c1939eda8af4a8bfd45cbda5edb9e41">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="fu">c</span>(<span class="st">'SPY'</span>, <span class="st">'GS'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SPY" "GS" </code></pre>
</div>
</div>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-4_736abc1564052bfd5078fef14aa7553a">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In Yahoo Finance data, the Adjusted column accounts for any stock splits that may have taken place.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(SPY<span class="sc">$</span>SPY.Adjusted) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"dark blue"</span>) <span class="sc">+</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SPY Prices from 2007 to 2017"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2018-01-02-Time-Series-Explainer_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So for example, if you wanted to write down the probability distribution that generate the prices, you would have to know where you are in time. Since the probability distribution that generated the prices keeps changing over time, the distribution is not stationary. This fact will mess up our statistical analysis.</p>
<p><span class="math display">\[p_t \sim N(\mu_t, \sigma_t)\]</span></p>
<p><em>Spurious Regression</em></p>
<p>One of the worst things non-stationary data does is set you up to believe that you have found a really strong relationship between two variables, when you really have just found a ‘spurious relationship’. In the figure below I plot SPY and Goldman Sachs (GS) prices from 2007 to 2017.</p>
<!-- ```{r} -->
<!-- #Not sure why this chunk can run in console, but won't knit. Oh well, saved to .png and embedded that way. -->
<!-- data <- cbind(SPY$SPY.Adjusted, GS$GS.Adjusted) -->
<!-- q <- autoplot(data, facets = FALSE) + -->
<!--   theme_bw() + -->
<!--   labs(title = "SPY and GS Prices from 2007 to 2017", x = "") -->
<!-- ggsave('images/nonstationary.png', width = 6, height = 4) -->
<!-- ``` -->
<p><img src="images/nonstationary.png" class="img-fluid"></p>
<p>To illustrate a ‘spurious regression’ let’s regress GS prices on lagged SPY prices. That means we are going to try to use yesterday’s prices of SPY to try to predict today’s GS prices.</p>
<p><span class="math display">\[GS_t = \beta_0 + \beta_1SPY_{t-1}  + \epsilon_t\]</span> The results of the regression are printed below. We find that lagged SPY prices are highly statistically significant predictors of GS prices. If you take these results to the stock market and think you can predict GS prices you will probably be very poor very soon.</p>
<p>The problem is that the ‘statistical significance’ comes from the fact that we just ran a super-consistent regression. That basically means that since the variables we used in the regression are (probably, we didn’t prove it here) non-stationary pretty much any regression we run will conclude statistical significance in a typical t-test. In other words, the regression results below aren’t valid because the statistic doesn’t follow the t distribution in the first place, but when you go along as it it does follow the t distribution, you will get ‘significant’ results almost every time.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-5_e8d93b6275ee238dd8e72102ae9e5599">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>GS <span class="ot">&lt;-</span> GS<span class="sc">$</span>GS.Adjusted</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>SPY <span class="ot">&lt;-</span> SPY<span class="sc">$</span>SPY.Adjusted</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>linMod <span class="ot">&lt;-</span> <span class="fu">lm</span>(GS <span class="sc">~</span>  <span class="fu">lag</span>(SPY))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(linMod, <span class="at">type  =</span> <span class="st">"html"</span>, <span class="at">title =</span> <span class="st">"GS Prices Regressed on Lagged GS and Lagged SPY Prices"</span>, <span class="at">align =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<table style="text-align:center">
<caption>
<strong>GS Prices Regressed on Lagged GS and Lagged SPY Prices</strong>
</caption>
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
GS
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lag(SPY)
</td>
<td>
0.642<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
51.244<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.004)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
4,066
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.836
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.836
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
30.854 (df = 4064)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
20,746.460<sup>***</sup> (df = 1; 4064)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
</div>
<p>You may be skeptical at this point. I mean, after all, it isn’t that crazy to think that today’s GS prices would be related to yesterday’s SPY prices. So to illustrate, now we’ll simulate two series so we are sure they are not related. Then we will regress one on the lag of the other and show statistical significance.</p>
<p>The simulated prices are plotted below.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-6_ec981d5e7fb5a92a409fabf0bc36e81e">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function, GBM() from the sde package simulates a geometric brownian motion. Which is the same a assuming prices follow a lognormal ditribution, and is the standard baseline model for prices. </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sde)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fakeSPY   <span class="ot">&lt;-</span> <span class="fu">GBM</span>(<span class="at">x =</span> <span class="dv">275</span>, <span class="at">r =</span> <span class="fl">0.15</span>, <span class="at">sigma =</span> .<span class="dv">2</span>, <span class="at">T =</span> <span class="dv">1</span>, <span class="at">N=</span><span class="dv">650</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fakeGS    <span class="ot">&lt;-</span> <span class="fu">GBM</span>(<span class="at">x =</span> <span class="dv">243</span>, <span class="at">r =</span> <span class="fl">0.10</span>, <span class="at">sigma =</span> .<span class="dv">3</span>, <span class="at">T =</span> <span class="dv">1</span>, <span class="at">N=</span><span class="dv">650</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-7_9a2ec4199c183e21c7f75745884b200a">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dates     <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2018-01-01"</span>), <span class="at">length =</span> <span class="dv">651</span>, <span class="at">by =</span> <span class="st">"days"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fakeSPY   <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="at">x=</span>fakeSPY, <span class="at">order.by =</span> dates)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fakeGS    <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="at">x=</span>fakeGS, <span class="at">order.by =</span> dates)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data      <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fakeSPY, fakeGS)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'fakeSPY'</span>, <span class="st">'fakeGS'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>data      <span class="ot">&lt;-</span> <span class="fu">tidy</span>(data)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value, <span class="at">color =</span> series)) <span class="sc">+</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulated SPY and Simulated GS Prices from 2007 to 2017"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2018-01-02-Time-Series-Explainer_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now lets run the same regression as we did with the real prices. The regression results are shown in the table.</p>
<p><span class="math display">\[fakeGS_t = \beta_0 + \beta_1fakeSPY_{t-1}  + \epsilon_t\]</span></p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-8_0f9c374c0d02706065ddac5f77c48c6d">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>linMod <span class="ot">&lt;-</span> <span class="fu">lm</span>(fakeGS <span class="sc">~</span>  <span class="fu">lag</span>(fakeSPY) )</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(linMod, <span class="at">type  =</span> <span class="st">"html"</span>, <span class="at">title =</span> <span class="st">"Simulated GS Prices Regressed on Lagged Simulated SPY Prices"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<table style="text-align:center">
<caption>
<strong>Simulated GS Prices Regressed on Lagged Simulated SPY Prices</strong>
</caption>
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
fakeGS
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lag(fakeSPY)
</td>
<td>
1.946<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.162)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-202.504<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(40.478)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
650
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.183
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.181
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
53.860 (df = 648)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
144.747<sup>***</sup> (df = 1; 648)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
</div>
<p>Huh, still crazy significant. It’s not a real relationship, but appears to be significant because we didn’t have any business doing a t-test here in the first place. We know the regression is meaningless because we simulated these prices to be independent ourselves. That is the problem with non-stationary data in a nutshell, if you regress non-stationary variables on one another, you will always get spurious ‘significant’ results.</p>
<p>So what to do? The answer is almost always this: if your data are non-stationary, convert the series into percentage changes by creating variables of logged price differences. In the context of the examples we have been using, that would be</p>
<p><span class="math display">\[SPYReturn_t = log(SPY_t) - log(SPY_{t-1}).  \]</span> Plotted, the price returns look like the following.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-9_6b3bb2a6ac34e434e267e37e17d1133f">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>SPYRet    <span class="ot">&lt;-</span> <span class="fu">log</span>(SPY) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(SPY))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>GSRet     <span class="ot">&lt;-</span> <span class="fu">log</span>(GS) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(GS))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>data      <span class="ot">&lt;-</span> <span class="fu">cbind</span>(SPYRet, GSRet)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'SPY'</span>, <span class="st">'GS'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data      <span class="ot">&lt;-</span> <span class="fu">tidy</span>(data)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> value, <span class="at">color =</span> series)) <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SPY Returns and GS Returns from 2007 to 2017"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="2018-01-02-Time-Series-Explainer_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Clearly, this is not exactly white noise. We have clear periods of heightened volatility (we’ll cover what to do about that in another post). But, at least the series are not trending up or down. We have solved the problem of non-stationarity by using price percent returns instead of price levels. Just to drive this point home, let’s regress GS returns on lagged SPY returns and show they are no longer significant.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-10_ab71116c463f38f03e0c6dc09fac51bf">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>linMod <span class="ot">&lt;-</span> <span class="fu">lm</span>(GSRet <span class="sc">~</span>  <span class="fu">lag</span>(SPYRet) )</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(linMod, <span class="at">type  =</span> <span class="st">"html"</span>, <span class="at">title =</span> <span class="st">"GS Returns Regressed on Lagged SPY Returns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<table style="text-align:center">
<caption>
<strong>GS Returns Regressed on Lagged SPY Returns</strong>
</caption>
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
GSRet
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
lag(SPYRet)
</td>
<td>
-0.035
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.028)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.0002
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0004)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
4,065
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.0004
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.0001
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.023 (df = 4063)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
1.508 (df = 1; 4063)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
</div>
<p>The statistical significance is gone! Bummer! But really this is good. It is a sign that the returns we generated are in fact stationary.</p>
</section>
</section>
<section id="stationarity-testing" class="level1">
<h1>Stationarity Testing</h1>
<p>We went through all the discussion above basically assuming that we knew whether or not the data were stationary or not. In real applied research, you always have to make a case whether or not the data are stationary to support your choice to use levels or returns in your analysis.</p>
<p>There are several stationarity tests, also often called Unit Root tests. I’ll list the main ones here.</p>
<ul>
<li>Augmented Dickey-Fuller Test
<ul>
<li>Null Hypothesis is Unit Root</li>
<li>Reject Null Hypothesis <span class="math inline">\(\Rightarrow\)</span> Series is stationary <span class="math inline">\(\Rightarrow\)</span> Use price levels</li>
<li>Fail to Reject <span class="math inline">\(\Rightarrow\)</span> Series has a unit root <span class="math inline">\(\Rightarrow\)</span> Use price returns</li>
<li>Said and Dickey (1984)</li>
</ul></li>
<li>Phillips-Perron (PP) Test
<ul>
<li>Null Hypothesis is Unit Root</li>
<li>Reject Null Hypothesis <span class="math inline">\(\Rightarrow\)</span> Series is stationary <span class="math inline">\(\Rightarrow\)</span> Use price levels</li>
<li>Fail to Reject <span class="math inline">\(\Rightarrow\)</span> Series has a unit root <span class="math inline">\(\Rightarrow\)</span> Use price returns</li>
<li>Perron (1988)</li>
</ul></li>
<li>KPSS-Test
<ul>
<li>Null Hypothesis is Stationarity</li>
<li>Reject Null Hypothesis <span class="math inline">\(\Rightarrow\)</span> Series has a Unit Root <span class="math inline">\(\Rightarrow\)</span> Use price returns</li>
<li>Fail to Reject <span class="math inline">\(\Rightarrow\)</span> Series is stationary <span class="math inline">\(\Rightarrow\)</span> Use price levels</li>
<li>Kwiatkowski, Phillips, Schmidt, Shin (1992)</li>
</ul></li>
</ul>
<p>The trouble facing a researcher is which test to use? Further complicating things is that the tests are generally known to be low power. This means it is pretty easy to fail to reject even when the alternative hypothesis is true, and it is not all that uncommon for the three tests to give conflicting results.</p>
<p>Because of this, the choice of levels versus returns is more of an art than a science. Also, the burden of proof is higher if you want to use series in levels. That is because there is nothing wrong with using returns of a stationary series, the statistics come out fine and all the stats 101 assumptions will hold. In cases like that it is most common to do the ADF test and move on. Even if it comes out stationary, you can make a case for why you are using returns and that is that.</p>
<p>However, when your choice to use returns or levels impacts whether or not we should believe your statistics, you may want to run all three and (hopefully) show all three tests are giving the same result, stationary or not.</p>
<p>To illustrate, let’s do the ADF, PP, and KPSS tests on the SPY and GS price series.</p>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-11_ebb481287b369b04c613de90adf90c72">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>adfSPY    <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">adf.test</span>(SPY))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>adfGS     <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">adf.test</span>(GS))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ppSPY     <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">pp.test</span>(SPY))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ppGS      <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">pp.test</span>(GS))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>kpssSPY   <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">kpss.test</span>(SPY))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>kpssGS    <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">kpss.test</span>(GS))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>kpssGS<span class="sc">$</span>alternative   <span class="ot">&lt;-</span>  <span class="st">"unit root"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>kpssSPY<span class="sc">$</span>alternative  <span class="ot">&lt;-</span>  <span class="st">"unit root"</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>unitroot  <span class="ot">&lt;-</span> <span class="fu">rbind</span>(adfSPY, ppSPY, kpssSPY, adfGS, ppGS, kpssGS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="unit-root-and-stationarity-test-results-for-spy-and-gs" class="level3">
<h3 class="anchored" data-anchor-id="unit-root-and-stationarity-test-results-for-spy-and-gs">Unit Root and Stationarity Test Results for SPY and GS</h3>
<div class="cell" data-hash="2018-01-02-Time-Series-Explainer_cache/html/unnamed-chunk-12_b3a3dec5dbafbc2d45b15bdd150a9ba0">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>unitroot[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">"SPY"</span>, <span class="dv">1</span>, <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="st">"GS"</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> statistic </th>
   <th style="text-align:right;"> p.value </th>
   <th style="text-align:left;"> method </th>
   <th style="text-align:left;"> alternative </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="3"><td colspan="4" style="border-bottom: 1px solid;"><strong>SPY</strong></td></tr>
<tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> -2.421300 </td>
   <td style="text-align:right;"> 0.3999408 </td>
   <td style="text-align:left;"> Augmented Dickey-Fuller Test </td>
   <td style="text-align:left;"> stationary </td>
  </tr>
  <tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> -9.700128 </td>
   <td style="text-align:right;"> 0.5687894 </td>
   <td style="text-align:left;"> Phillips-Perron Unit Root Test </td>
   <td style="text-align:left;"> stationary </td>
  </tr>
  <tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> 33.148452 </td>
   <td style="text-align:right;"> 0.0100000 </td>
   <td style="text-align:left;"> KPSS Test for Level Stationarity </td>
   <td style="text-align:left;"> unit root </td>
  </tr>
  <tr grouplength="3"><td colspan="4" style="border-bottom: 1px solid;"><strong>GS</strong></td></tr>
<tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> -2.324644 </td>
   <td style="text-align:right;"> 0.4408690 </td>
   <td style="text-align:left;"> Augmented Dickey-Fuller Test </td>
   <td style="text-align:left;"> stationary </td>
  </tr>
  <tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> -10.733072 </td>
   <td style="text-align:right;"> 0.5111909 </td>
   <td style="text-align:left;"> Phillips-Perron Unit Root Test </td>
   <td style="text-align:left;"> stationary </td>
  </tr>
  <tr>
   <td style="text-align:right;padding-left: 2em;" indentlevel="1"> 23.248790 </td>
   <td style="text-align:right;"> 0.0100000 </td>
   <td style="text-align:left;"> KPSS Test for Level Stationarity </td>
   <td style="text-align:left;"> unit root </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Notice that in these examples, the results are not controversial all tests point toward there being unit roots in SPY and GS prices. We fail to reject the null hypothesis in all tests where unit root is the null hypothesis, and we reject the null hypothesis for all tests where unit root is the alternative hypothesis.</p>
<p>Stay tuned for the next posts in this series where I will explain the next basic issues in time-series econometrics.</p>
<ul>
<li><p>Determining if Variables “Move Together” or are Otherwise Correlated</p></li>
<li><p>Adjusting for Residuals that may not be Perfect “White Noise”</p></li>
</ul>
</section>
</section>
<section id="books-to-get-you-started" class="level1">
<h1>Books to Get You Started</h1>
<p>Now that you know the game we play in time-series analysis, you might be interested in getting started learning more about how to actually apply these statistics and models to poke around at research ideas. I recommend the following books for self-study. They are both very approachable and hands-on.</p>
<section id="enders-applied-time-series-econometrics" class="level3">
<h3 class="anchored" data-anchor-id="enders-applied-time-series-econometrics">Enders’ Applied Time Series Econometrics</h3>
<p><a href="http://time-series.net/">Walter Enders’</a> “<a href="https://www.amazon.com/Applied-Econometric-Wiley-Probability-Statistics/dp/1118808568/ref=dp_ob_title_bk">Applied Time Series Econometrics</a>”, is a wonderful book and is basically how I learned to ‘do time series’ when I was under the gun finishing my own dissertation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.amazon.com/Applied-Econometric-Wiley-Probability-Statistics/dp/1118808568/ref=dp_ob_title_bk"><img src="images/Enders.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Applied Time Series Econometrics</figcaption><p></p>
</figure>
</div>
</section>
<section id="colonescus-using-r-for-principles-of-econometrics" class="level3">
<h3 class="anchored" data-anchor-id="colonescus-using-r-for-principles-of-econometrics">Colonescu’s Using R for Principles of Econometrics</h3>
<p>Recently, I found Constantin Colonescu’s “Using R for Principles of Econometrics” (for now, a draft is available for free <a href="https://bookdown.org/ccolonescu/RPoE4/">here</a>). What I really like about this book is that it can be effectively used to both learn applied econometrics and also to learn how to do applied econometrics in R.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="http://www.lulu.com/shop/constantin-colonescu/using-r-for-principles-of-econometrics/paperback/product-23467421.html"><img src="images/RPrinciplesMetrics.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Using R for Principles of Econometrics</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Kwiatkowski, D., Phillips, P. C., Schmidt, P., &amp; Shin, Y. (1992). “Testing the null hypothesis of stationarity against the alternative of a unit root: How sure are we that economic time series have a unit root?” <em>Journal of econometrics</em>, 54(1-3), 159-178.</p>
<p>Perron, P. (1988). “Trends and random walks in macroeconomic time series: Further evidence from a new approach.” <em>Journal of economic dynamics and control</em>, 12(2), 297-332.</p>
<p>Said, S. E., &amp; Dickey, D. A. (1984). “Testing for unit roots in autoregressive-moving average models of unknown order.” <em>Biometrika</em>, 71(3), 599-607.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>